---
parameters:
  - name: action
    type: string
    values:
      - Default
      - DryRun
  - name: gitUserEmail
    type: string
  - name: gitUserName
    type: string
  - name: organisationName
    type: string
  - name: pool
    type: object
  - name: rangerVersion
    type: string
  - name: timeoutInMinutes
    type: number
    default: 60

resources:
  repositories:
    - repository: self

jobs:
  - job: Execute
    pool: ${{ parameters.pool }}
    steps:
      - task: InstallRangerCLI@0
        inputs:
          version: ${{ parameters.rangerVersion }}
      - task: DeploySet@0
        inputs:
          gitUserEmail: ${{ parameters.gitUserEmail }}
          gitUserName: ${{ parameters.gitUserName }}
          organisationName: ${{ parameters.organisationName }}
          pat: $(System.AccessToken)
          projectName: $(System.TeamProject)
      - task: PromoteSet@0
        inputs:
          gitUserEmail: ${{ parameters.gitUserEmail }}
          gitUserName: ${{ parameters.gitUserName }}
          organisationName: ${{ parameters.organisationName }}
          pat: $(System.AccessToken)
          projectName: $(System.TeamProject)
